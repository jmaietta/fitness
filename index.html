<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forge</title>

    <meta name="description" content="A simple and effective fitness app for stretching, cardio, and resistance training complemented by modern nutritional intelligence.">

    <link rel="canonical" href="https://forgebodyfit.com/">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://forgebodyfit.com/">
    <meta property="og:title" content="Forge Fitness">
    <meta property="og:description" content="A simple and effective fitness app for stretching, cardio, and resistance training complemented by modern nutritional intelligence.">
    <meta property="og:image" content="https://forgebodyfit.com/forge-logo.png">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://forgebodyfit.com/">
    <meta property="twitter:title" content="Forge Fitness">
    <meta property="twitter:description" content="A simple and effective fitness app for stretching, cardio, and resistance training complemented by modern nutritional intelligence.">
    <meta property="twitter:image" content="https://forgebodyfit.com/forge-logo.png">

    <!-- Preconnect to external resources for faster loading -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
</head>
<body>
    <main class="app-container">
        
        <img src="forge-logo.png" alt="Forge Fitness - Home" class="app-logo">

        <div id="quote-box" class="quote-box" role="complementary" aria-label="Motivational quote"></div>

        <!-- Navigation Tabs -->
        <nav class="tabs" role="tablist" aria-label="Workout categories">
            <button class="tab-button active" data-target="stretching" role="tab" aria-selected="true" aria-controls="stretching" id="tab-stretching">
                <i class="fa-solid fa-child-reaching" aria-hidden="true"></i> Stretching
            </button>
            <button class="tab-button" data-target="cardio" role="tab" aria-selected="false" aria-controls="cardio" id="tab-cardio">
                <i class="fa-solid fa-person-running" aria-hidden="true"></i> Cardio
            </button>
            <button class="tab-button" data-target="resistance" role="tab" aria-selected="false" aria-controls="resistance" id="tab-resistance">
                <i class="fa-solid fa-dumbbell" aria-hidden="true"></i> Resistance
            </button>
            <button class="tab-button" data-target="nutrition" role="tab" aria-selected="false" aria-controls="nutrition" id="tab-nutrition">
                <i class="fa-solid fa-utensils" aria-hidden="true"></i> Nutrition
            </button>
        </nav>

        <!-- Stretching Section -->
        <section id="stretching" class="tab-content active" role="tabpanel" aria-labelledby="tab-stretching">
            <header class="section-header">
                <h2>Stretching Routine</h2>
                <p>Improve your flexibility, reduce muscle tension, and prevent injuries with these essential stretches.</p>
            </header>
            <ul role="list">
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="neck-stretch.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Neck Stretch</span>
                            <span class="exercise-reps">2 sets • 15-second hold</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Gently tilt your head, bringing your ear toward your shoulder until you feel a light stretch.</p>
                        <img src="neck-stretch.png" alt="Neck stretch demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="shoulder-stretch.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Shoulder Stretch</span>
                            <span class="exercise-reps">2 sets • 15-second hold per side</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Cross one arm over your chest and use the other arm to gently pull it closer to your body.</p>
                        <img src="shoulder-stretch.png" alt="Shoulder stretch demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="hamstring-stretch.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Hamstring Stretch</span>
                            <span class="exercise-reps">2 sets • 30-second hold per leg</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Sit on the floor with one leg extended, the other bent. Lean forward over the straight leg.</p>
                        <img src="hamstring-stretch.png" alt="Hamstring stretch demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="quad-stretch.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Quad Stretch</span>
                            <span class="exercise-reps">2 sets • 30-second hold per leg</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>While standing, hold onto a support, grab your ankle and gently pull your heel towards your glute.</p>
                        <img src="quad-stretch.png" alt="Quad stretch demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="calf-stretch.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Calf Stretch</span>
                            <span class="exercise-reps">2 sets • 30-second hold per leg</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Stand facing a wall with one foot forward. Lean into the wall, keeping your back leg straight.</p>
                        <img src="calf-stretch.png" alt="Calf stretch demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
            </ul>
        </section>

        <!-- Cardio Section -->
        <section id="cardio" class="tab-content" role="tabpanel" aria-labelledby="tab-cardio" hidden>
            <header class="section-header">
                <h2>Cardio Routine</h2>
                <p>Get your heart rate up and improve your cardiovascular endurance with these effective exercises.</p>
            </header>
            <ul role="list">
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="jumping-jacks.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Jumping Jacks</span>
                            <span class="exercise-reps">3 sets • 30 seconds</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>A full-body exercise. Jump while spreading your legs and bringing your arms overhead.</p>
                        <img src="jumping-jacks.png" alt="Jumping Jacks demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="burpee.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Burpees</span>
                            <span class="exercise-reps">3 sets • 10 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>A challenging full-body move: squat, kick legs back to a plank, return to squat, and jump up.</p>
                        <img src="burpee.png" alt="Burpee sequence demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="high-knees.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">High Knees</span>
                            <span class="exercise-reps">3 sets • 30 seconds</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Run in place, bringing your knees up towards your chest as high as possible.</p>
                        <img src="high-knees.png" alt="High Knees demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="mountain-climbers.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Mountain Climbers</span>
                            <span class="exercise-reps">3 sets • 30 seconds</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>From a plank position, alternate bringing each knee towards your chest, as if running.</p>
                        <img src="mountain-climbers.png" alt="Mountain Climbers demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
            </ul>
        </section>

        <!-- Resistance Section -->
        <section id="resistance" class="tab-content" role="tabpanel" aria-labelledby="tab-resistance" hidden>
            <header class="section-header">
                <h2>Resistance Routine</h2>
                <p>Build strength and tone your muscles using these foundational bodyweight resistance exercises.</p>
            </header>
            <ul role="list">
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="push-up.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Push-ups</span>
                            <span class="exercise-reps">3 sets • 10 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Lower your body until your chest nearly touches the floor, keeping your back straight.</p>
                        <img src="push-up.png" alt="Push-up demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="squats.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Squats</span>
                            <span class="exercise-reps">3 sets • 15 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Lower your hips as if sitting in a chair, keeping your chest up and back straight.</p>
                        <img src="squats.png" alt="Squats demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="lunges.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Lunges</span>
                            <span class="exercise-reps">3 sets • 10 reps each leg</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Step forward with one leg and lower your hips until both knees are bent at a 90-degree angle.</p>
                        <img src="lunges.png" alt="Lunges demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="plank.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Plank</span>
                            <span class="exercise-reps">3 sets • 30-second hold</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Hold a push-up position, keeping your body in a straight line from head to heels.</p>
                        <img src="plank.png" alt="Plank demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="glute-bridge.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Glute Bridges</span>
                            <span class="exercise-reps">3 sets • 15 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Lie on your back, lift your hips off the floor until your body forms a straight line.</p>
                        <img src="glute-bridge.png" alt="Glute Bridges demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="chair-dip.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Chair Dips</span>
                            <span class="exercise-reps">3 sets • 12 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Using a sturdy chair, lower your body down with your arms until your elbows are at 90 degrees.</p>
                        <img src="chair-dip.png" alt="Chair Dips demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="calf-raises.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Calf Raises</span>
                            <span class="exercise-reps">3 sets • 20 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Stand with feet flat on the floor, then push through the balls of your feet to raise your heels.</p>
                        <img src="calf-raises.png" alt="Calf Raises demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <img src="Supermans.png" alt="" class="exercise-thumbnail" loading="lazy">
                        <div class="exercise-info">
                            <span class="exercise-name">Supermans</span>
                            <span class="exercise-reps">3 sets • 12 reps</span>
                        </div>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <p>Lie on your stomach and simultaneously lift your arms, legs, and chest off the floor.</p>
                        <img src="Supermans.png" alt="Supermans demonstration" class="exercise-photo" loading="lazy">
                    </div>
                </li>
            </ul>
        </section>

        <!-- Nutrition Section -->
        <section id="nutrition" class="tab-content" role="tabpanel" aria-labelledby="tab-nutrition" hidden>
            <ul role="list">
                <li>
                    <div class="exercise-header" role="button" tabindex="0" aria-expanded="false">
                        <span class="exercise-name">
                            Daily Macro Calculator
                            <button class="tooltip-trigger" 
                                    type="button"
                                    aria-label="What are macros and how does this calculator work?"
                                    data-tooltip="true">
                                <i class="fa-solid fa-circle-info" aria-hidden="true"></i>
                            </button>
                        </span>
                        <span class="expand-icon" aria-hidden="true">
                            <i class="fa-solid fa-chevron-right"></i>
                        </span>
                    </div>
                    <div class="details" hidden>
                        <div class="calculator-container">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="weight">Weight (lbs)</label>
                                    <input type="number" 
                                           id="weight" 
                                           placeholder="e.g., 180"
                                           min="50" 
                                           max="500"
                                           aria-describedby="weight-hint"
                                           required>
                                    <span id="weight-hint" class="visually-hidden">Enter your weight between 50 and 500 pounds</span>
                                </div>
                                <div class="form-group">
                                    <label for="height">Height (inches)</label>
                                    <input type="number" 
                                           id="height" 
                                           placeholder="e.g., 68"
                                           min="36" 
                                           max="96"
                                           aria-describedby="height-hint"
                                           required>
                                    <span id="height-hint" class="visually-hidden">Enter your height between 36 and 96 inches</span>
                                </div>
                                <div class="form-group">
                                    <label for="age">Age</label>
                                    <input type="number" 
                                           id="age" 
                                           placeholder="e.g., 35"
                                           min="13" 
                                           max="120"
                                           aria-describedby="age-hint"
                                           required>
                                    <span id="age-hint" class="visually-hidden">Enter your age between 13 and 120 years</span>
                                </div>
                                <div class="form-group">
                                    <label for="gender">Gender</label>
                                    <select id="gender">
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="activity">Activity Level</label>
                                    <select id="activity">
                                        <option value="1.2">Sedentary (little or no exercise)</option>
                                        <option value="1.375">Lightly Active (light exercise 1-3 days/week)</option>
                                        <option value="1.55" selected>Moderately Active (moderate exercise 3-5 days/week)</option>
                                        <option value="1.725">Very Active (hard exercise 6-7 days/week)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="goal">Goal</label>
                                    <select id="goal">
                                        <option value="cut">Fat Loss</option>
                                        <option value="maintain" selected>Maintain</option>
                                        <option value="bulk">Muscle Gain</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Error message container -->
                            <div id="calculator-error" class="error-message" role="alert" hidden></div>
                            <button class="calculate-btn" id="calculateBtn" type="button">
                                <i class="fa-solid fa-calculator" aria-hidden="true"></i> Calculate
                            </button>
                        </div>
                    </div>
                </li>
            </ul>
        </section>
    </main>

    <!-- Results Modal Overlay -->
    <div class="results-container" id="resultsContainer" role="dialog" aria-labelledby="results-title" aria-modal="true" hidden>
        <div class="results-card">
            <div class="results-card-header">
                <h3 id="results-title">Your Daily Targets</h3>
            </div>
            <div class="results-card-body">
                <div class="macro-stats">
                    <div class="stat">
                        <span class="stat-value" id="caloriesResult">0</span>
                        <span class="stat-label">Calories</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="proteinResult">0g</span>
                        <span class="stat-label">Protein</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="carbsResult">0g</span>
                        <span class="stat-label">Carbs</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="fatResult">0g</span>
                        <span class="stat-label">Fat</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tooltip container (dynamically populated) -->
    <div id="tooltip" class="tooltip" role="tooltip" aria-hidden="true"></div>

    <script src="food_data.js"></script>
    <script src="script.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize tooltips
            initTooltips();
            
            // Select all images that should be zoomable
            const zoomableImages = document.querySelectorAll('.exercise-photo, .exercise-images img');

            zoomableImages.forEach(image => {
                image.addEventListener('click', () => {
                    // Create the overlay div
                    const overlay = document.createElement('div');
                    overlay.classList.add('fullscreen-overlay');
                    overlay.setAttribute('role', 'dialog');
                    overlay.setAttribute('aria-label', 'Enlarged image view');

                    // Create the image element to show inside the overlay
                    const fullscreenImage = document.createElement('img');
                    fullscreenImage.src = image.src;
                    fullscreenImage.alt = image.alt;

                    // Add the image to the overlay
                    overlay.appendChild(fullscreenImage);
                    
                    // Add the overlay to the page
                    document.body.appendChild(overlay);

                    // A tiny delay to allow the browser to render the overlay before animating it
                    setTimeout(() => {
                        overlay.classList.add('active');
                    }, 10);
                    
                    // Close overlay function
                    const closeOverlay = () => {
                        overlay.classList.remove('active');
                        setTimeout(() => {
                            document.body.removeChild(overlay);
                        }, 300);
                    };
                    
                    // Add event listener to close the overlay when clicked
                    overlay.addEventListener('click', closeOverlay);
                    
                    // Close on Escape key
                    const handleEscape = (e) => {
                        if (e.key === 'Escape') {
                            closeOverlay();
                            document.removeEventListener('keydown', handleEscape);
                        }
                    };
                    document.addEventListener('keydown', handleEscape);
                });
            });
        });

        /**
         * Initialize tooltip functionality following best practices
         */
        function initTooltips() {
            const tooltip = document.getElementById('tooltip');
            const triggers = document.querySelectorAll('[data-tooltip="true"]');
            let hideTimeout;
            let currentTrigger = null;
            
            const tooltipContent = {
                default: `
                    <div class="tooltip-header">
                        <h4>What Are Macros?</h4>
                    </div>
                    <div class="tooltip-body">
                        <p><strong>Macronutrients</strong> are the three main nutrients your body needs in large amounts:</p>
                        <ul>
                            <li><strong>Protein:</strong> Builds and repairs muscle tissue</li>
                            <li><strong>Carbohydrates:</strong> Provides energy for workouts and daily activities</li>
                            <li><strong>Fats:</strong> Supports hormone production and brain function</li>
                        </ul>
                        <p>This calculator determines your personalized daily targets based on your body composition, activity level, and fitness goals.</p>
                    </div>
                `
            };

            triggers.forEach(trigger => {
                // Add ARIA attributes for accessibility
                const tooltipId = 'tooltip-' + Math.random().toString(36).substr(2, 9);
                trigger.setAttribute('aria-describedby', tooltipId);
                
                // Mouse events for desktop
                trigger.addEventListener('mouseenter', (e) => {
                    clearTimeout(hideTimeout);
                    showTooltip(e, tooltip, tooltipContent.default);
                    currentTrigger = trigger;
                });
                
                trigger.addEventListener('mouseleave', (e) => {
                    // Only hide if not moving to tooltip
                    hideTimeout = setTimeout(() => {
                        if (!tooltip.matches(':hover') && !trigger.matches(':hover')) {
                            hideTooltip(tooltip);
                            currentTrigger = null;
                        }
                    }, 100);
                });
                
                // Touch events for mobile
                trigger.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    if (tooltip.classList.contains('visible')) {
                        hideTooltip(tooltip);
                        currentTrigger = null;
                    } else {
                        showTooltip(e, tooltip, tooltipContent.default);
                        currentTrigger = trigger;
                    }
                });
                
                // Focus events for keyboard accessibility
                trigger.addEventListener('focus', (e) => {
                    clearTimeout(hideTimeout);
                    showTooltip(e, tooltip, tooltipContent.default);
                    currentTrigger = trigger;
                });
                
                trigger.addEventListener('blur', () => {
                    hideTimeout = setTimeout(() => {
                        hideTooltip(tooltip);
                        currentTrigger = null;
                    }, 100);
                });
            });

            // Allow hovering over tooltip itself
            tooltip.addEventListener('mouseenter', () => {
                clearTimeout(hideTimeout);
            });
            
            tooltip.addEventListener('mouseleave', () => {
                hideTimeout = setTimeout(() => {
                    if (currentTrigger && !currentTrigger.matches(':hover')) {
                        hideTooltip(tooltip);
                        currentTrigger = null;
                    }
                }, 100);
            });

            // Hide tooltip when clicking elsewhere
            document.addEventListener('click', (e) => {
                if (!e.target.closest('[data-tooltip="true"]') && !e.target.closest('.tooltip')) {
                    hideTooltip(tooltip);
                    currentTrigger = null;
                }
            });

            // Hide tooltip on escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    hideTooltip(tooltip);
                    currentTrigger = null;
                }
            });
        }

        function showTooltip(event, tooltip, content) {
            tooltip.innerHTML = content;
            tooltip.style.display = 'block';
            tooltip.setAttribute('aria-hidden', 'false');
            
            // Position the tooltip
            positionTooltip(event.target, tooltip);
            
            // Animate in
            requestAnimationFrame(() => {
                tooltip.classList.add('visible');
            });
        }

        function hideTooltip(tooltip) {
            tooltip.classList.remove('visible');
            tooltip.setAttribute('aria-hidden', 'true');
            setTimeout(() => {
                if (!tooltip.classList.contains('visible')) {
                    tooltip.style.display = 'none';
                }
            }, 200);
        }

        function positionTooltip(trigger, tooltip) {
            const triggerRect = trigger.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            let left = triggerRect.left + (triggerRect.width / 2) - (tooltipRect.width / 2);
            let top = triggerRect.top - tooltipRect.height - 10;
            
            // Adjust if tooltip goes off-screen horizontally
            if (left < 10) {
                left = 10;
            } else if (left + tooltipRect.width > viewportWidth - 10) {
                left = viewportWidth - tooltipRect.width - 10;
            }
            
            // Adjust if tooltip goes off-screen vertically (show below instead)
            if (top < 10) {
                top = triggerRect.bottom + 10;
                tooltip.classList.add('tooltip-below');
            } else {
                tooltip.classList.remove('tooltip-below');
            }
            
            tooltip.style.left = left + 'px';
            tooltip.style.top = top + 'px';
        }
    </script>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
                });
        }
    </script>
</body>
</html>
